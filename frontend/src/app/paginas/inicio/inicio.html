<div class="layout">

  <!-- OVERLAY MÓVIL (para cerrar el sidebar tocando fuera) -->
  <div
    class="mobile-overlay"
    [class.show]="sidebarOpen"
    (click)="closeSidebar()">
  </div>

  <!-- SIDEBAR -->
  <aside
    class="sidebar"
    [class.collapsed]="sidebarCollapsed"
    [class.show]="sidebarOpen">

    <!-- LOGO -->
    <div class="sidebar-logo">
      <img
        src="/logo-rtv.png"
        alt="Logo RTV"
        class="logo"
      />
      <span *ngIf="!sidebarCollapsed">RTV</span>
    </div>

    <!-- MENÚ DE NAVEGACIÓN -->
    <nav class="menu">

      <!-- Dashboard -->
      <div class="menu-item">
        <mat-icon class="menu-icon">dashboard</mat-icon>
        <span *ngIf="!sidebarCollapsed">Dashboard</span>
      </div>

      <!-- ========================================
           GESTIÓN VEHICULAR
           ======================================== -->
      <div class="menu-section">
        <span *ngIf="!sidebarCollapsed" class="section-title">
          Gestión Vehicular
        </span>

        <div class="menu-item-expandable">
          <div
            class="menu-item"
            (click)="toggleGestionVehicular()"
            [class.active]="gestionVehicularOpen">
            <mat-icon class="menu-icon">directions_car</mat-icon>
            <span *ngIf="!sidebarCollapsed">Gestión Vehicular</span>
            <mat-icon
              *ngIf="!sidebarCollapsed"
              class="menu-arrow"
              [class.rotated]="gestionVehicularOpen">
              expand_more
            </mat-icon>
          </div>

          <div class="submenu" [class.open]="gestionVehicularOpen && !sidebarCollapsed">
            <a class="submenu-item">Vehículos</a>
            <a class="submenu-item">Propietario</a>
            <a class="submenu-item">Revisiones</a>
            <a class="submenu-item">Resultados de Revisión</a>
          </div>
        </div>
      </div>

      <!-- ========================================
           OPERACIONES
           ======================================== -->
      <div class="menu-section">
        <span *ngIf="!sidebarCollapsed" class="section-title">
          Operaciones
        </span>

        <div class="menu-item-expandable">
          <div
            class="menu-item"
            (click)="toggleOperaciones()"
            [class.active]="operacionesOpen">
            <mat-icon class="menu-icon">account_balance_wallet</mat-icon>
            <span *ngIf="!sidebarCollapsed">Operaciones</span>
            <mat-icon
              *ngIf="!sidebarCollapsed"
              class="menu-arrow"
              [class.rotated]="operacionesOpen">
              expand_more
            </mat-icon>
          </div>

          <div class="submenu" [class.open]="operacionesOpen && !sidebarCollapsed">
            <a class="submenu-item">Pagos</a>
            <a class="submenu-item">Certificados</a>
          </div>
        </div>
      </div>

      <!-- ========================================
           CATÁLOGO DE VEHÍCULOS
           ======================================== -->
      <div class="menu-section">
        <span *ngIf="!sidebarCollapsed" class="section-title">
          Catálogo de Vehículos
        </span>

        <div class="menu-item-expandable">
          <div
            class="menu-item"
            (click)="toggleCatalogoVehiculos()"
            [class.active]="catalogoVehiculosOpen">
            <mat-icon class="menu-icon">library_books</mat-icon>
            <span *ngIf="!sidebarCollapsed">Catálogo de Vehículos</span>
            <mat-icon
              *ngIf="!sidebarCollapsed"
              class="menu-arrow"
              [class.rotated]="catalogoVehiculosOpen">
              expand_more
            </mat-icon>
          </div>

          <div class="submenu" [class.open]="catalogoVehiculosOpen && !sidebarCollapsed">
            <a routerLink="/inicio/catalogo-vehiculos/marcas" routerLinkActive="active" class="submenu-item">Marcas</a>
            <a routerLink="/inicio/catalogo-vehiculos/modelos" routerLinkActive="active" class="submenu-item">Modelos</a>
            <a class="submenu-item">Tipos de Vehículo</a>
            <a routerLink="/inicio/catalogo-vehiculos/clases" routerLinkActive="active" class="submenu-item">Clases</a>
            <a routerLink="/inicio/catalogo-vehiculos/categorias" routerLinkActive="active" class="submenu-item">Categorías</a>
            <a class="submenu-item">Subcategorías</a>
            <a routerLink="/inicio/catalogo-vehiculos/tipo-combustible" routerLinkActive="active" class="submenu-item">Tipos de Combustible</a>
            <a routerLink="/inicio/catalogo-vehiculos/tipo-matricula" routerLinkActive="active" class="submenu-item">Tipos de Matrícula</a>
            <a routerLink="/inicio/catalogo-vehiculos/traccion" routerLinkActive="active" class="submenu-item">Tracción</a>
            <a routerLink="/inicio/catalogo-vehiculos/ejes" routerLinkActive="active" class="submenu-item">Ejes</a>
            <a routerLink="/inicio/catalogo-vehiculos/capacidad-carga" routerLinkActive="active" class="submenu-item">Capacidad de Carga</a>
            <a routerLink="/inicio/catalogo-vehiculos/ambito-operacional" routerLinkActive="active" class="submenu-item">Ámbito Operacional</a>
          </div>
        </div>
      </div>

      <!-- ========================================
           INSPECCIÓN RTV
           ======================================== -->
      <div class="menu-section">
        <span *ngIf="!sidebarCollapsed" class="section-title">
          Inspección RTV
        </span>

        <div class="menu-item-expandable">
          <div
            class="menu-item"
            (click)="toggleInspeccionRtv()"
            [class.active]="inspeccionRtvOpen">
            <mat-icon class="menu-icon">fact_check</mat-icon>
            <span *ngIf="!sidebarCollapsed">Inspección RTV</span>
            <mat-icon
              *ngIf="!sidebarCollapsed"
              class="menu-arrow"
              [class.rotated]="inspeccionRtvOpen">
              expand_more
            </mat-icon>
          </div>

          <div class="submenu" [class.open]="inspeccionRtvOpen && !sidebarCollapsed">
            <a routerLink="/inicio/inspeccion-rtv/lineas-inspeccion" routerLinkActive="active" class="submenu-item">Líneas de Inspección</a>
            <a routerLink="/inicio/inspeccion-rtv/metodo-inspeccion" routerLinkActive="active" class="submenu-item">Métodos de Inspección</a>
            <a routerLink="/inicio/inspeccion-rtv/equipos" routerLinkActive="active" class="submenu-item">Equipos</a>
          </div>
        </div>
      </div>

      <!-- ========================================
           DEFECTOS DE INSPECCIÓN
           ======================================== -->
      <div class="menu-section">
        <span *ngIf="!sidebarCollapsed" class="section-title">
          Defectos de Inspección
        </span>

        <div class="menu-item-expandable">
          <div
            class="menu-item"
            (click)="toggleDefectosInspeccion()"
            [class.active]="defectosInspeccionOpen">
            <mat-icon class="menu-icon">warning</mat-icon>
            <span *ngIf="!sidebarCollapsed">Defectos de Inspección</span>
            <mat-icon
              *ngIf="!sidebarCollapsed"
              class="menu-arrow"
              [class.rotated]="defectosInspeccionOpen">
              expand_more
            </mat-icon>
          </div>

          <div class="submenu" [class.open]="defectosInspeccionOpen && !sidebarCollapsed">
            <a routerLink="/inicio/defectos-inspeccion/familia-defecto" routerLinkActive="active" class="submenu-item">Familias de Defectos</a>
            <a routerLink="/inicio/defectos-inspeccion/subfamilia-defecto" routerLinkActive="active" class="submenu-item">Subfamilias de Defectos</a>
            <a routerLink="/inicio/defectos-inspeccion/categoria-defecto" routerLinkActive="active" class="submenu-item">Categorías de Defectos</a>
            <a routerLink="/inicio/defectos-inspeccion/tipos-defecto" routerLinkActive="active" class="submenu-item">Tipos de Defectos</a>
          </div>
        </div>
      </div>

      <!-- ========================================
           ANT / TRÁMITES
           ======================================== -->
      <div class="menu-section">
        <span *ngIf="!sidebarCollapsed" class="section-title">
          ANT / Trámites
        </span>

        <div class="menu-item-expandable">
          <div
            class="menu-item"
            (click)="toggleAntTramites()"
            [class.active]="antTramitesOpen">
            <mat-icon class="menu-icon">description</mat-icon>
            <span *ngIf="!sidebarCollapsed">ANT / Trámites</span>
            <mat-icon
              *ngIf="!sidebarCollapsed"
              class="menu-arrow"
              [class.rotated]="antTramitesOpen">
              expand_more
            </mat-icon>
          </div>

          <div class="submenu" [class.open]="antTramitesOpen && !sidebarCollapsed">
            <a class="submenu-item">Tipos de Trámite</a>
            <a class="submenu-item">Estados de Trámite</a>
            <a class="submenu-item">Tipos de Excepción</a>
            <a class="submenu-item">Estados de Excepción</a>
            <a class="submenu-item">Estados de Multa</a>
            <a class="submenu-item">Tarifario</a>
            <a class="submenu-item">Documentos Requeridos</a>
            <a class="submenu-item">Entidades de Tránsito</a>
            <a class="submenu-item">Formas de Pago</a>
            <a class="submenu-item">Tipos de Documento</a>
          </div>
        </div>
      </div>

      <!-- ========================================
           CONFIGURACIÓN UMBRAL
           ======================================== -->
      <div class="menu-section">
        <span *ngIf="!sidebarCollapsed" class="section-title">
          Configuración Umbral
        </span>

        <div class="menu-item-expandable">
          <div
            class="menu-item"
            (click)="toggleConfiguracionUmbral()"
            [class.active]="configuracionUmbralOpen">
            <mat-icon class="menu-icon">tune</mat-icon>
            <span *ngIf="!sidebarCollapsed">Configuración Umbral</span>
            <mat-icon
              *ngIf="!sidebarCollapsed"
              class="menu-arrow"
              [class.rotated]="configuracionUmbralOpen">
              expand_more
            </mat-icon>
          </div>

          <div class="submenu" [class.open]="configuracionUmbralOpen && !sidebarCollapsed">
            <a class="submenu-item">Unidades de Medida</a>
            <a class="submenu-item">Descripción de Umbral</a>
          </div>
        </div>
      </div>

      <!-- ========================================
           ADMINISTRACIÓN
           ======================================== -->
      <div class="menu-section">
        <span *ngIf="!sidebarCollapsed" class="section-title">
          Administración
        </span>

        <div class="menu-item-expandable">
          <div
            class="menu-item"
            (click)="toggleAdministracion()"
            [class.active]="administracionOpen">
            <mat-icon class="menu-icon">group</mat-icon>
            <span *ngIf="!sidebarCollapsed">Administración</span>
            <mat-icon
              *ngIf="!sidebarCollapsed"
              class="menu-arrow"
              [class.rotated]="administracionOpen">
              expand_more
            </mat-icon>
          </div>

          <div class="submenu" [class.open]="administracionOpen && !sidebarCollapsed">
            <a routerLink="/inicio/administracion/usuarios" routerLinkActive="active" class="submenu-item">Usuarios</a>
            <a routerLink="/inicio/administracion/roles" routerLinkActive="active" class="submenu-item">Roles</a>
            <a routerLink="/inicio/administracion/areas" routerLinkActive="active" class="submenu-item">Áreas</a>
            <a routerLink="/inicio/administracion/empresa" routerLinkActive="active" class="submenu-item">Empresa</a>
          </div>
        </div>
      </div>

    </nav>
  </aside>

  <!-- CONTENIDO PRINCIPAL -->
  <div class="main">

    <!-- HEADER -->
    <header class="header">

      <div class="left">
        <button class="hamburger" (click)="toggleSidebar()">
          <mat-icon>menu</mat-icon>
        </button>

        <img
          src="/logo-rtv.png"
          alt=""
          class="header-logo"
        />
        <span class="title">Revisión Técnica Vehicular</span>
      </div>

      <div class="right">
        <!-- Información de usuario -->
        <mat-icon class="user-icon">person</mat-icon>
        <span class="user">{{ nombreUsuario }}</span>

        <!-- Botón de cerrar sesión -->
        <button class="logout" (click)="cerrarSesion()">
          <mat-icon>logout</mat-icon>
          <span>Salir</span>
        </button>
      </div>

    </header>

    <!-- CONTENIDO DINÁMICO -->
    <main class="content">
      <router-outlet></router-outlet>
    </main>

  </div>

</div>
